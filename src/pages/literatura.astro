---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

// Recenzje książek
const recenzjeKsiazek = (await getCollection('recenzje'))
  .filter(p => p.data.medium === 'książka')
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());

// Twórczość literacka - może być pusta
let tworczoscLiteracka: any[] = [];
try {
  tworczoscLiteracka = (await getCollection('tworczosc'))
    .filter(p => p.data.medium === 'literatura')
    .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
} catch (e) {
  // Kolekcja nie istnieje lub jest pusta
}
---

<BaseLayout title="literatura">
  <div class="page">
    <header class="page-header">
      <h1 class="page-title">literatura</h1>
      <p class="page-desc">Recenzje książek i własna twórczość literacka</p>
    </header>

    {tworczoscLiteracka.length > 0 && (
      <section class="section">
        <h2 class="section-title">twórczość</h2>
        <div class="posts-grid">
          {tworczoscLiteracka.map((post) => (
            <PostCard
              href={`/${post.slug}`}
              title={post.data.title}
              date={post.data.date}
              description={post.data.description}
              lang={post.data.lang}
            />
          ))}
        </div>
      </section>
    )}

    {recenzjeKsiazek.length > 0 && (
      <section class="section">
        <h2 class="section-title">recenzje książek</h2>
        <div class="posts-grid">
          {recenzjeKsiazek.map((post) => (
            <PostCard
              href={`/${post.slug}`}
              title={post.data.title}
              date={post.data.date}
              description={post.data.description}
              lang={post.data.lang}
              work={post.data.work}
            />
          ))}
        </div>
      </section>
    )}

    <nav class="page-nav">
      <a class="nav-link" href="/">← wróć</a>
    </nav>
  </div>
</BaseLayout>
